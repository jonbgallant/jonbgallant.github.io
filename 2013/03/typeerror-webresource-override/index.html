<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Solution to &quot;TypeError: m[5] is undefined&quot;, &quot;TypeError: Cannot read property length of undefined&quot; and How to Override JavaScript in ASP.NET WebResource.axd files | Jon Gallant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="asp.net,howto,javascript" />
    
    <meta name="description" content="You’ll sometimes get this error in Firefox and Chrome, but not IE.

“TypeError: m[5] is undefined”

“TypeError: Cannot read property ‘length’ of undefined”
There has been a known issue with Firefox an">
<meta property="og:type" content="article">
<meta property="og:title" content="Solution to "TypeError: m[5] is undefined", "TypeError: Cannot read property length of undefined" and How to Override JavaScript in ASP.NET WebResource.axd files">
<meta property="og:url" content="http://blog.jongallant.com/2013/03/typeerror-webresource-override/index.html">
<meta property="og:site_name" content="Jon Gallant">
<meta property="og:description" content="You’ll sometimes get this error in Firefox and Chrome, but not IE.

“TypeError: m[5] is undefined”

“TypeError: Cannot read property ‘length’ of undefined”
There has been a known issue with Firefox an">
<meta property="og:image" content="http://blog.jongallant.com/images/blog/Solution-to-TypeError_57B3/image.png">
<meta property="og:updated_time" content="2016-12-29T03:37:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Solution to "TypeError: m[5] is undefined", "TypeError: Cannot read property length of undefined" and How to Override JavaScript in ASP.NET WebResource.axd files">
<meta name="twitter:description" content="You’ll sometimes get this error in Firefox and Chrome, but not IE.

“TypeError: m[5] is undefined”

“TypeError: Cannot read property ‘length’ of undefined”
There has been a known issue with Firefox an">
<meta name="twitter:image" content="http://blog.jongallant.com/images/blog/Solution-to-TypeError_57B3/image.png">
    

    
        <link rel="alternate" href="http://feeds.feedburner.com/jongallant" title="Jon Gallant" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1148981-8', 'auto');
ga('send', 'pageview');

</script>
    
    

</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">tech.leadership.music.coffee</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/">Leadership</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Career-Model/">Career Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Productivity/">Productivity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Review-Model/">Review Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Work-Life-Balance/">Work:Life Balance</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Musings/">Musings</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/">Tech</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/3D-Printing/">3D Printing</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Announcements/">Announcements</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Azure/">Azure</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Bugs/">Bugs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Career/">Career</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Conferences/">Conferences</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/IoT/">IoT</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Jobs/">Jobs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Microsoft/">Microsoft</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Power-BI/">Power BI</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tips/">Tips</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tutorials/">Tutorials</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/archives/">Archive</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/contact/">Contact</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/category/Tech/">Tech</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/category/Tech/Tutorials/">Tutorials</a>
    </h1>
</div>

                        
                        <div class="main-body-content">
                        <div class="banner-ad">
                        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- banner -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7253926757222509"
     data-ad-slot="8838481977"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
                            <article id="post-typeerror-webresource-override" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Solution to &quot;TypeError: m[5] is undefined&quot;, &quot;TypeError: Cannot read property length of undefined&quot; and How to Override JavaScript in ASP.NET WebResource.axd files
        </h1>
    

            </header>
        
        
            <div class="article-subtitle">
                
<a href="/2013/03/typeerror-webresource-override/" class="article-date">
    <time datetime="2013-03-05T06:47:00.000Z" itemprop="datePublished">2013-03-05</time>
</a>

                
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/asp-net/">asp.net</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/howto/">howto</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>You’ll sometimes get this error in Firefox and Chrome, but not IE.</p>
<p><img src="/images/blog/Solution-to-TypeError_57B3/image.png" alt=""></p>
<p><em>“TypeError: m[5] is undefined”</em></p>
<p><img src="/images/blog/Solution-to-TypeError_57B3/image_3.png" alt=""></p>
<p><em>“TypeError: Cannot read property ‘length’ of undefined”</em></p>
<p>There has been a known issue with Firefox and Chrome when you combine RegularExpressionValidators and RequiredFieldValidators. It’s been around since 2009, but no one has addressed the issue. Here’s the bug report on ASP.NET forums: <a href="http://forums.asp.net/t/1417973.aspx" title="http://forums.asp.net/t/1417973.aspx" target="_blank" rel="external">http://forums.asp.net/t/1417973.aspx</a> and here’s the bug report filed to Mozilla for the FF issue <a href="https://bugzilla.mozilla.org/show_bug.cgi/attachment.cgi?id=512979" title="https://bugzilla.mozilla.org/show_bug.cgi/attachment.cgi?id=512979" target="_blank" rel="external">https://bugzilla.mozilla.org/show_bug.cgi/attachment.cgi?id=512979</a>. Neither of them have a solution.</p>
<p>I narrowed it down to these lines of code in WebResource.axd – the one with the Validator control JavaScript that starts with </p>
<p>var Page_ValidationVer = “125”;<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> (m != <span class="literal">null</span> &amp;amp;&amp;amp; (m[<span class="number">2</span>].length == <span class="number">4</span> || val.dateorder == <span class="string">"ymd"</span>)) &#123;</div><div class="line">  year = (m[<span class="number">5</span>].length == <span class="number">4</span>) ? m[<span class="number">5</span>] : GetFullYear(<span class="built_in">parseInt</span>(m[<span class="number">6</span>], <span class="number">10</span>))</div></pre></td></tr></table></figure></p>
<p>The root of the problem is that the WebResource JavaScript isn’t checking if “m[2]” and “m[5]” are undefined before checking the “length” property. The obvious fix is to do just that, but it’s embedded in an automatically generated WebResource.axd file. You can’t edit it directly, but since Microsoft didn’t scope the JavaScript properly you can override that method if you insert a method with the same name at the bottom of the page.</p>
<p>Here’s how I resolved it:</p>
<p>1. Create a new .js file called WebResourceOverrides.js</p>
<p>2. Copy the entire “ValidatorConvert” method from the WebResource.axd file to the file I created in Step 1.</p>
<p>3. Modify the method to check for undefined</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="comment">// added m[2] undefined check because it was failing in FF and Chrome</span></div><div class="line"><span class="keyword">if</span> (m != <span class="literal">null</span> &amp;&amp; ( (<span class="keyword">typeof</span>(m[<span class="number">2</span>]) != <span class="string">'undefined'</span> &amp;&amp; m[<span class="number">2</span>].length == <span class="number">4</span>) || val.dateorder == <span class="string">"ymd"</span>)) &#123;</div><div class="line"></div><div class="line">.</div><div class="line">.</div><div class="line">.</div><div class="line"></div><div class="line"><span class="comment">// added m[5] undefined check because it was failing in FF and Chrome</span></div><div class="line">year = (<span class="keyword">typeof</span> m[<span class="number">5</span>] != <span class="string">'undefined'</span> &amp;amp;&amp;amp; m[<span class="number">5</span>].length == <span class="number">4</span>) ? m[<span class="number">5</span>] : GetFullYear(<span class="built_in">parseInt</span>(m[<span class="number">6</span>], <span class="number">10</span>))</div></pre></td></tr></table></figure>
<p>4. Reference that new js file AT THE BOTTOM OF my master page<br><figure class="highlight"><table><tr><td class="code"><pre><div class="line">&lt;script type="text/javascript" src="/WebResourceOverrides.js"&lt;/script&gt;</div></pre></td></tr></table></figure></p>
<p>You can download my version of the WebResourceOverrides.js file from here: <a href="http://jongallant.com/blogassets/WebResourceOverrides.js.txt" target="_blank" rel="external">http://jongallant.com/blogassets/WebResourceOverrides.js.txt</a>. Just remove the “.txt” extension, copy to your site, add the reference to the bottom of your master page and you are good to go.</p>
<p>Jon</p>

        </div>
        <footer class="article-footer">
            



    <a data-url="http://blog.jongallant.com/2013/03/typeerror-webresource-override/" data-id="cj4io7ix2010tpcj4l4nqspis" class="article-share-link"><i class="fa fa-share"></i>Share</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

                        </div>
                        <div style="width:64%;margin:auto;" data-type="ad" data-publisher="lqm.jongallant.site" data-format="728x90" data-zone="ros" data-tags="iot%2cangularjs%2cjavascript%2cnode%2cazureiot%2cazure%2cpowerbi%2cseattle%2cdeveloper%2cmicrosoft%2ctutorials"></div>
                    </section>
                    
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2017 Jon Gallant</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a>. Hosting provided by <a href="http://birch.com" target="_blank">Birch</a>. <p>Disclaimer: The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'jongallant';
    
    
    var disqus_url = 'http://blog.jongallant.com/2013/03/typeerror-webresource-override/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>

    <script type='text/javascript'>
function _dmBootstrap(file) {
    var _dma = document.createElement('script');
    _dma.type = 'text/javascript';
    _dma.async = true;
    _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
}
function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
(function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
    
</body>
</html>
