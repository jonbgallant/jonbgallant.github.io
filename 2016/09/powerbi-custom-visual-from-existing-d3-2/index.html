<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 2 - Capabilities, dataRoles and dataViewMappings | Jon Gallant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="dev,powerbi" />
    
    <meta name="description" content="UPDATE: The Liquid Fill Gauge visual is now available to download from the Power BI Custom Visual Gallery!
–
This is a continuation of my attempt at creating a Power BI Custom Visual from an OSS d3 vi">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 2 - Capabilities, dataRoles and dataViewMappings">
<meta property="og:url" content="https://blog.jongallant.com/2016/09/powerbi-custom-visual-from-existing-d3-2/index.html">
<meta property="og:site_name" content="Jon Gallant">
<meta property="og:description" content="UPDATE: The Liquid Fill Gauge visual is now available to download from the Power BI Custom Visual Gallery!
–
This is a continuation of my attempt at creating a Power BI Custom Visual from an OSS d3 vi">
<meta property="og:image" content="https://blog.jongallant.com/images/blog/53494a0089db_D4F8/image.png">
<meta property="og:updated_time" content="2018-05-16T20:39:41.368Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 2 - Capabilities, dataRoles and dataViewMappings">
<meta name="twitter:description" content="UPDATE: The Liquid Fill Gauge visual is now available to download from the Power BI Custom Visual Gallery!
–
This is a continuation of my attempt at creating a Power BI Custom Visual from an OSS d3 vi">
<meta name="twitter:image" content="https://blog.jongallant.com/images/blog/53494a0089db_D4F8/image.png">
    

    
        <link rel="alternate" href="http://feeds.feedburner.com/jongallant" title="Jon Gallant" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <script type="text/javascript">
    (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-1148981-8', 'auto');
    ga('send', 'pageview');

</script>
    
    


</head>


    <body>
        <div id="wrap">
            <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">tech.leadership.music.coffee</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/">Leadership</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Career-Model/">Career Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Productivity/">Productivity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Review-Model/">Review Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Work-Life-Balance/">Work:Life Balance</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Musings/">Musings</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/">Tech</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/3D-Printing/">3D Printing</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Announcements/">Announcements</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Azure/">Azure</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Bugs/">Bugs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Career/">Career</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Conferences/">Conferences</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/IoT/">IoT</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Jobs/">Jobs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Microsoft/">Microsoft</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Power-BI/">Power BI</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tips/">Tips</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tutorials/">Tutorials</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/archives/">Archive</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/contact/">Contact</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
                <div class="container">
                    <div class="main-body container-inner">
                        <div class="main-body-inner">
                            <section id="main">
                                
                                    <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/category/Tech/">Tech</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/category/Tech/Power-BI/">Power BI</a>
    </h1>
</div>

                                        
                                            <div class="main-body-content">
                                                <div class="banner-ad">
                                                    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                                                    <!-- banner -->
                                                    <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7253926757222509" data-ad-slot="8838481977" data-ad-format="auto"></ins>
                                                    <script>
                                                        (adsbygoogle = window.adsbygoogle || []).push({});
                                                    </script>
                                                </div>
                                                <article id="post-powerbi-custom-visual-from-existing-d3-2" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 2 - Capabilities, dataRoles and dataViewMappings
        </h1>
    

            </header>
        
        
            <div class="article-subtitle">
                
<a href="/2016/09/powerbi-custom-visual-from-existing-d3-2/" class="article-date">
    <time datetime="2016-09-29T15:51:00.000Z" itemprop="datePublished">2016-09-29</time>
</a>

                
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/dev/">dev</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powerbi/">powerbi</a></li></ul>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p><span style="font-size: large;">UPDATE: The Liquid Fill Gauge visual is now available to download from the <a href="https://app.powerbi.com/visuals/show/PBI_CV_94E55AB3_5D45_4B62_A49D_19E2109AA028" target="_blank" rel="external">Power BI Custom Visual Gallery</a>!</span><br>
<span style="font-size: large;">–</span><br>
This is a continuation of my attempt at creating a Power BI Custom Visual from an OSS d3 visual I found on GitHub. In this post I’m going to focus on the “capabilities” of the visual. Here’s the previous post: <a href="/2016/09/how-to-create-power-bi-custom-visual.html">How to Create a Power BI Custom Visual Based on an Existing d3 Visual</a>. It’s a liquidFillGauge that was originally created by <a href="https://gist.github.com/brattonc/5e5ce9beee483220e2f6" target="_blank" rel="external">Curtis Bratton</a>.</p>
<p>This is Part 2 of the series, here are the other posts:</p>
<p>1. <a href="/2016/09/how-to-create-power-bi-custom-visual.html">How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 1 - Dev Env Setup, Reference and Testing</a></p>
<p>3. <a href="/2016/10/powerbi-custom-visual-from-existing-d3-3.html">How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 3 - Custom Format Properties</a></p>
<p>You can install this visual from the GitHub releases page <a href="https://github.com/jongio/PowerBI-visuals-liquidFillGauge/releases" target="_blank" rel="external">here</a>. I’ll put in the <a href="http://visuals.powerbi.com/" target="_blank" rel="external">Power BI Visual Gallery</a> once the visual is complete.</p>
<p>I found <a href="https://github.com/Microsoft/PowerBI-visuals/blob/master/Tutorial/DataBinding.md" target="_blank" rel="external">this page</a> helpful when looking into Power BI Custom Visual Data Roles.</p>
<p>Here’s what the Liquid Fill Gauge looks like in Power BI.</p>
<p><img src="/images/blog/53494a0089db_D4F8/image.png" alt=""></p>
<p>In the root of your project you have a capabilities.json file. This is where you define how the user can assign data to your visual. Each “dataRole” that you define in this file can be a “Grouping”, “Measure” or “GroupingOrMeasure” data role. I think about it like this: Grouping is like categories of data, sets of data, whereas Measure is a single value…GroupingOrMeasure is when the value can either be a Grouping or a Measure.</p>
<p>In the case of the liquidFillGauge, we really only need to assign one value at this point - the fill percentage. The first version of the visual used the default capabilities.json file that comes with the template when created via “pbiviz new visualName”.</p>
<p>The default capabilities comes with two dataRoles “Grouping” and “Measure” like so:<br>
<img src="/images/blog/53494a0089db_D4F8/image_3.png" alt=""></p>
<script src="https://gist.github.com/jongio/75f312fa9cc27ea0780e805a3a600127.js"></script>
<p>Since we only need a single value (at the moment, but we might need more in the future). We can remove the Grouping field and change the name, like so:</p>
<script src="https://gist.github.com/jongio/c7ebf8116b1420035437051c933f3f46.js"></script>
<p>And if you just use that you’ll see this:<br>
<img src="/images/blog/53494a0089db_D4F8/image_4.png" alt=""><br>
What you need to do is define a dataViewMappings object that tells the visual how to represent the dataRoles in the dataView. Again, this is a super simple visual right now, so all we need to do is map the single value. I’ve seen examples where “role” is equal to “Values”, but removing it doesn’t seem to impact anything, so I’m leaving it as an empty string.</p>
<p>You’ll also need to add the “object” property, I explain that in <a href="/2016/10/powerbi-custom-visual-from-existing-d3-3.html">Part 3</a>.</p>
<p>Open capabilities.json and add this code:</p>
<script src="https://gist.github.com/jongio/6b4a4cc023252152a9864ab762814177.js"></script>
<p>Your visualization pane should now look like this:<br>
<img src="/images/blog/53494a0089db_D4F8/image_5.png" alt=""></p>
<p>And your format property pane will look like this:</p>
<div class="separator" style="clear: both; text-align: center;">![](/images/blog/2016-12-05 22_13_06-Power BI.png)
<p>The resulting visual is the same as the original. We just now have cleaner data and format panes….and less code.</p>
<p>Keep following along in <a href="/2016/10/powerbi-custom-visual-from-existing-d3-3.html">Part 3</a>…<br>
Jon</p>
</div>
        </div>
        <footer>
        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                                            </div>
                                            <div style="width:64%;margin:auto;" data-type="ad" data-publisher="lqm.jongallant.site" data-format="728x90" data-zone="ros"
                                                data-tags="iot%2cangularjs%2cjavascript%2cnode%2cazureiot%2cazure%2cpowerbi%2cseattle%2cdeveloper%2cmicrosoft%2ctutorials"></div>
                            </section>
                            <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar">
        <i class="toggle icon"></i>
    </a>
    <div class="sidebar-top">

        <ul class="social-links">
            
                
                    <li>
                        <a class="social-tooltip" title="twitter" href="http://twitter.com/jongallant" target="_blank">
                            <i class="icon fa fa-twitter"></i>
                        </a>
                    </li>
                    
                        
                
                    <li>
                        <a class="social-tooltip" title="github" href="https://github.com/jongio" target="_blank">
                            <i class="icon fa fa-github"></i>
                        </a>
                    </li>
                    
                        
                
                    <li>
                        <a class="social-tooltip" title="rss" href="http://feeds.feedburner.com/jongallant" target="_blank">
                            <i class="icon fa fa-rss"></i>
                        </a>
                    </li>
                    
                        
                
                    <li>
                        <a class="social-tooltip" title="linkedin" href="http://www.linkedin.com/in/jongallant" target="_blank">
                            <i class="icon fa fa-linkedin"></i>
                        </a>
                    </li>
                    
                        
                
                    <li>
                        <a class="social-tooltip" title="youtube" href="https://www.youtube.com/channel/UCcEFb5apnJUMC7npvsoozTQ" target="_blank">
                            <i class="icon fa fa-youtube"></i>
                        </a>
                    </li>
                    
                        
        </ul>
    </div>
    
        
    <nav id="article-nav">
        
            <a href="/2016/10/powerbi-custom-visual-from-existing-d3-3/" id="article-nav-newer" class="article-nav-link-wrap">
                <strong class="article-nav-caption">
                    newer
                </strong>
                <p class="article-nav-title">
                    
                        How to Create a Power BI Custom Visual Based on an Existing d3 Visual - Part 3 - Custom Format Properties
                            
                </p>
                <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>

            </a>
            
                
                    <a href="/2016/09/powerbi-cant-contact-visual-server/" id="article-nav-older" class="article-nav-link-wrap">
                        <strong class="article-nav-caption">
                            older
                        </strong>
                        <p class="article-nav-title">
                            Solution: Power BI - &quot;Can&#39;t contact visual server. Please make sure the visual server is running and configured correctly.&quot;
                        </p>
                        <i class="icon fa fa-chevron-right" id="icon-chevron-right"></i>

                    </a>
                    
    </nav>
    
            

                <div class="widgets-container">
                    
                        
                            <br/>
<div style="position:relative;height:0;padding-bottom:56.25%"><iframe src="https://www.youtube.com/embed/videoseries?list=PLiMIJTv6gK5_Zmdcmbo-kxAbpeGjSou9x&amp;showinfo=0?ecver=2" width="640" height="360" frameborder="0" gesture="media" allow="encrypted-media" style="position:absolute;width:100%;height:100%;left:0" allowfullscreen></iframe></div>
<br/>
                                
                            <a class="twitter-timeline" data-height="700" href="https://twitter.com/jongallant?ref_src=twsrc%5Etfw"></a> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
                                
                                <div style="width:88%;margin:auto;" data-type="ad" data-publisher="lqm.jongallant.site" data-format="300x250" data-zone="ros" data-tags="iot%2cangularjs%2cjavascript%2cnode%2cazureiot%2cazure%2cpowerbi%2cseattle%2cdeveloper%2cmicrosoft%2ctutorials"></div>

                                
                                    

                                        <div class="rail-ad">
                                            <!-- rail -->
                                            <ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-7253926757222509" data-ad-slot="7222147978" data-ad-format="auto"></ins>
                                            <script>
                                                (adsbygoogle = window.adsbygoogle || []).push({});
                                            </script>
                                        </div>
                </div>

</aside>
                        </div>
                    </div>
                </div>
                <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo-n"></a>
                </h1>
                <p>&copy; 2018 Jon Gallant</p>
                <p>Disclaimer: The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</p>
            </div>
            
        </div>
    </div>
</footer>
                    
    
    <script>
    var disqus_shortname = 'jongallant';
    
    
    var disqus_url = 'https://blog.jongallant.com/2016/09/powerbi-custom-visual-from-existing-d3-2/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

        </div>

        <script type='text/javascript'>
            function _dmBootstrap(file) {
                var _dma = document.createElement('script');
                _dma.type = 'text/javascript';
                _dma.async = true;
                _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
            }
            function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
            (function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
        </script>
    </body>

    </html>