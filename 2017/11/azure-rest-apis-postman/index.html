<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Azure REST APIs with Postman in 2 Minutes | Jon Gallant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="azure,postman,rest" />
    
    <meta name="description" content="The Azure REST APIs require a Bearer Token Authorization header. The docs do a great job explaining every authentication requirement, but do not tell you how to quickly get started.  This post will ho">
<meta property="og:type" content="article">
<meta property="og:title" content="Azure REST APIs with Postman in 2 Minutes">
<meta property="og:url" content="http://blog.jongallant.com/2017/11/azure-rest-apis-postman/index.html">
<meta property="og:site_name" content="Jon Gallant">
<meta property="og:description" content="The Azure REST APIs require a Bearer Token Authorization header. The docs do a great job explaining every authentication requirement, but do not tell you how to quickly get started.  This post will ho">
<meta property="og:image" content="http://blog.jongallant.com/2017/11/azure-rest-apis-postman/20.png">
<meta property="og:updated_time" content="2017-12-02T00:30:01.960Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Azure REST APIs with Postman in 2 Minutes">
<meta name="twitter:description" content="The Azure REST APIs require a Bearer Token Authorization header. The docs do a great job explaining every authentication requirement, but do not tell you how to quickly get started.  This post will ho">
<meta name="twitter:image" content="http://blog.jongallant.com/2017/11/azure-rest-apis-postman/20.png">
    

    
        <link rel="alternate" href="http://feeds.feedburner.com/jongallant" title="Jon Gallant" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1148981-8', 'auto');
ga('send', 'pageview');

</script>
    
    

</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">tech.leadership.music.coffee</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/">Leadership</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Career-Model/">Career Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Productivity/">Productivity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Review-Model/">Review Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Work-Life-Balance/">Work:Life Balance</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Musings/">Musings</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/">Tech</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/3D-Printing/">3D Printing</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Announcements/">Announcements</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Azure/">Azure</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Bugs/">Bugs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Career/">Career</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Conferences/">Conferences</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/IoT/">IoT</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Jobs/">Jobs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Microsoft/">Microsoft</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Power-BI/">Power BI</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tips/">Tips</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tutorials/">Tutorials</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/archives/">Archive</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/contact/">Contact</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/category/Tech/">Tech</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/category/Tech/Tips/">Tips</a>
    </h1>
</div>

                        
                        <div class="main-body-content">
                        <div class="banner-ad">
                        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- banner -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7253926757222509"
     data-ad-slot="8838481977"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
                            <article id="post-azure-rest-apis-postman" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        Azure REST APIs with Postman in 2 Minutes
        </h1>
    

            </header>
        
        
            <div class="article-subtitle">
                
<a href="/2017/11/azure-rest-apis-postman/" class="article-date">
    <time datetime="2017-11-29T19:55:12.000Z" itemprop="datePublished">2017-11-29</time>
</a>

                
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/azure/">azure</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/postman/">postman</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/rest/">rest</a></li></ul>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>The <a href="https://docs.microsoft.com/en-us/rest/api/" target="_blank" rel="external">Azure REST APIs</a> require a Bearer Token Authorization header. The docs do a great job explaining every authentication requirement, but do not tell you how to quickly get started.  This post will hopefully solve that for you.</p>
<p>We’ll first create an <strong>Azure Active Directory Service Principal</strong> and use it in <a href="http://getpostman.com" target="_blank" rel="external"><strong>Postman</strong></a> to generate a <strong>Bearer Token</strong> and then call the <strong>Azure REST APIs</strong>.</p>
<h2 id="azure-setup"><a class="header-anchor" href="#azure-setup"></a>Azure Setup</h2>
<blockquote>
<p>Note that the below configuration uses the default Service Principal configuration values. In a production application you are going to want to configure the Service Principal to be constrained to specific areas of your Azure resources.  You can find more about the configuration options <a href="https://docs.microsoft.com/en-us/cli/azure/ad/sp?view=azure-cli-latest" target="_blank" rel="external">here</a>.</p>
</blockquote>
<h5 id="1-install-python-2-7"><a class="header-anchor" href="#1-install-python-2-7"></a>1. Install <a href="https://www.python.org/downloads/" target="_blank" rel="external">Python 2.7+</a></h5>
<p>The Azure CLI is written in Python, so you’ll need Python to execute any of the CLI commands.</p>
<h5 id="2-install-azure-cli-2-0"><a class="header-anchor" href="#2-install-azure-cli-2-0"></a>2. Install <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="external">Azure CLI 2.0</a></h5>
<h5 id="3-login-to-cli"><a class="header-anchor" href="#3-login-to-cli"></a>3. Login to CLI</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">az login</span><br></pre></td></tr></table></figure>
<p><img src="00.png" alt=""></p>
<ul>
<li>Go to <a href="http://aka.ms/devicelogin" target="_blank" rel="external">http://aka.ms/devicelogin</a> and enter the code show in the console.</li>
</ul>
<h5 id="4-set-active-subscription"><a class="header-anchor" href="#4-set-active-subscription"></a>4. Set Active Subscription</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">az account <span class="built_in">set</span> --subscription <span class="string">"your subscription name or id"</span></span><br></pre></td></tr></table></figure>
<p><img src="01.png" alt=""></p>
<h5 id="5-create-service-principal"><a class="header-anchor" href="#5-create-service-principal"></a>5. Create Service Principal</h5>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">az ad sp create-for-rbac -n <span class="string">"your service principal name"</span></span><br></pre></td></tr></table></figure>
<p><img src="02.png" alt=""></p>
<blockquote>
<p>Copy this output to a temp location, you will need the values in a minute.</p>
</blockquote>
<h6 id="service-principal-password-reset"><a class="header-anchor" href="#service-principal-password-reset"></a>Service Principal Password Reset</h6>
<p>You can execute the following command if you ever need to reset your Service Principal password.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">az ad sp reset-credentials --name <span class="string">"your service principal name"</span></span><br></pre></td></tr></table></figure>
<p>You can read more about Service Principals <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-application-objects" target="_blank" rel="external">here</a>.</p>
<h2 id="postman-setup"><a class="header-anchor" href="#postman-setup"></a>Postman Setup</h2>
<p>We are now going to use Postman to execute a REST call to get the Bearer Token and another to Get Resource Groups.</p>
<h5 id="1-install-postman"><a class="header-anchor" href="#1-install-postman"></a>1. Install <a href="http://getpostman.com" target="_blank" rel="external">Postman</a></h5>
<h5 id="2-close-postman"><a class="header-anchor" href="#2-close-postman"></a>2. Close Postman</h5>
<blockquote>
<p>The next step only works if Postman is closed.  Please close Postman now.</p>
</blockquote>
<h5 id="3-click-run-in-postman"><a class="header-anchor" href="#3-click-run-in-postman"></a>3. Click “Run in Postman”</h5>
<p>Click this button:</p>
<p><a href="https://app.getpostman.com/run-collection/41b9fa3b957c297f283d#?env%5BAzure%20REST%5D=W3siZW5hYmxlZCI6dHJ1ZSwia2V5IjoidGVuYW50SWQiLCJ2YWx1ZSI6IiIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJjbGllbnRJZCIsInZhbHVlIjoiIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6ImNsaWVudFNlY3JldCIsInZhbHVlIjoiIiwidHlwZSI6InRleHQifSx7ImVuYWJsZWQiOnRydWUsImtleSI6InJlc291cmNlIiwidmFsdWUiOiJodHRwczovL21hbmFnZW1lbnQuYXp1cmUuY29tLyIsInR5cGUiOiJ0ZXh0In0seyJlbmFibGVkIjp0cnVlLCJrZXkiOiJzdWJzY3JpcHRpb25JZCIsInZhbHVlIjoiIiwidHlwZSI6InRleHQifV0=" target="_blank" rel="external"><img src="https://run.pstmn.io/button.svg" alt=""></a></p>
<p>This will open your browser and present you with two options.  Select the best option for you under “Open with…”  On Windows select “Open with…Postman for Windows”</p>
<p><img src="27.png" alt=""></p>
<h5 id="4-inspect-requests"><a class="header-anchor" href="#4-inspect-requests"></a>4. Inspect Requests</h5>
<p>You will notice that there is a new collection in Postman called “Azure REST”.  Take a few minutes to inspect the requests and get familiar with them.</p>
<p><img src="18.png" alt=""></p>
<h6 id="get-aad-token-request"><a class="header-anchor" href="#get-aad-token-request"></a>Get AAD Token Request</h6>
<p>This request will POST to <code>https://login.microsoftonline.com//oauth2/token</code> with our Service Principal settings and then, in the “Tests” will set a Postman Global Variable called <code>bearerToken</code> to the <code>access_token</code> in the response.</p>
<p><img src="20.png" alt=""></p>
<p><img src="22.png" alt=""></p>
<h6 id="get-resource-groups-request"><a class="header-anchor" href="#get-resource-groups-request"></a>Get Resource Groups Request</h6>
<p>This request will GET <code>https://management.azure.com/subscriptions//resourcegroups?api-version=2017-05-10</code> with an Authorization header set to the Bearer Token we just requested with ‘Get AAD Token’.</p>
<p><img src="21.png" alt=""></p>
<h5 id="5-set-environment-variables"><a class="header-anchor" href="#5-set-environment-variables"></a>5. Set Environment Variables</h5>
<p>When you clicked on the “Run in Postman” button Postman also created an Environment for you called “Azure REST”.  You will now set your Service Principal settings in the Environment to be used in the requests.</p>
<ul>
<li>Click on the gear icon in the upper right hand corner of Postman and select Manage Environments.</li>
</ul>
<p><img src="04.png" alt=""></p>
<ul>
<li>Click on the <code>Azure REST</code> Environment and you will see all the required settings.</li>
</ul>
<p><img src="30.png" alt=""></p>
<ul>
<li>Enter all your settings from the Service Principal we created earlier.  Here’s how they map:</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="code"><pre><span class="line">tenant = tenantId</span><br><span class="line">appId = clientId</span><br><span class="line">password = clientSecret</span><br><span class="line">subscriptionId is the same</span><br></pre></td></tr></table></figure>
<p>When you are done it will look like this with all the values filled in:</p>
<p><img src="24.png" alt=""></p>
<p>Make sure that the <code>Azure REST</code> Environment is selected in the Environment dropdown in the upper right hand corner of Postman.</p>
<p><img src="31.png" alt=""></p>
<p>We are now ready to execute the requests!</p>
<h5 id="4-execute-get-aad-token-request"><a class="header-anchor" href="#4-execute-get-aad-token-request"></a>4. Execute Get AAD Token Request</h5>
<p>First, we will execute the Get AAD Token request to get our Bearer Token and put it in a Postman global variable.</p>
<ul>
<li>Open the Get AAD Token request and click the <strong>Send</strong> button.</li>
</ul>
<p>You will see the following output:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"> &#123;</span><br><span class="line">    <span class="string">"token_type"</span>: <span class="string">"Bearer"</span>,</span><br><span class="line">    <span class="string">"expires_in"</span>: <span class="string">"3599"</span>,</span><br><span class="line">    <span class="string">"ext_expires_in"</span>: <span class="string">"0"</span>,</span><br><span class="line">    <span class="string">"expires_on"</span>: <span class="string">"1512031433"</span>,</span><br><span class="line">    <span class="string">"not_before"</span>: <span class="string">"1512027533"</span>,</span><br><span class="line">    <span class="string">"resource"</span>: <span class="string">"https://management.azure.com/"</span>,</span><br><span class="line">    <span class="string">"access_token"</span>: <span class="string">"eyJ0eXAiOiJKV...tS-OmwIfRw"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="25.png" alt=""></p>
<p>The <code>access_token</code> property is now stored a global variable, which was set in the “Tests” tab.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">pm.globals.set(<span class="string">"bearerToken"</span>, pm.response.json().access_token);</span><br></pre></td></tr></table></figure>
<h5 id="5-execute-get-resource-groups-request"><a class="header-anchor" href="#5-execute-get-resource-groups-request"></a>5. Execute Get Resource Groups Request</h5>
<p>We’ll now execute any Azure REST API with that Bearer Token. Just as an exercise, we’ll execute the Get Resource Groups request.</p>
<ul>
<li>Open the Get Resource Groups request and click the Send button.</li>
</ul>
<p>You will see the following output:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"value"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="string">"id"</span>: <span class="string">"/subscriptions/.../resourceGroups/cloud-shell-storage-westus"</span>,</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"cloud-shell-storage-westus"</span>,</span><br><span class="line">            <span class="string">"location"</span>: <span class="string">"westus"</span>,</span><br><span class="line">            <span class="string">"properties"</span>: &#123;</span><br><span class="line">                <span class="string">"provisioningState"</span>: <span class="string">"Succeeded"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="26.png" alt=""></p>
<p>That’s all there is to it. Now you can go an explore all of the Azure REST APIs and use this same method to generate the required Bearer Token Authorization header.</p>
<p>Please let me know if you run in to any issues.</p>
<p>Jon</p>

        </div>
        <footer>
        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                        <div style="width:64%;margin:auto;" data-type="ad" data-publisher="lqm.jongallant.site" data-format="728x90" data-zone="ros" data-tags="iot%2cangularjs%2cjavascript%2cnode%2cazureiot%2cazure%2cpowerbi%2cseattle%2cdeveloper%2cmicrosoft%2ctutorials"></div>
                    </section>
                    
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2017 Jon Gallant</p>
                <p>Disclaimer: The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'jongallant';
    
    
    var disqus_url = 'http://blog.jongallant.com/2017/11/azure-rest-apis-postman/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>

    <script type='text/javascript'>
function _dmBootstrap(file) {
    var _dma = document.createElement('script');
    _dma.type = 'text/javascript';
    _dma.async = true;
    _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
}
function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
(function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
    
</body>
</html>
