<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>How to Embed and Filter a Power BI Report with the new Power BI Embedded JavaScript API | Jon Gallant</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="powerbi" />
    
    <meta name="description" content="I was recently asked to help build a “Range Slider” Power BI Custom Visual that simply filters a report based on the slider value. Unfortunately “filtering” is not currently supported in the new Power">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Embed and Filter a Power BI Report with the new Power BI Embedded JavaScript API">
<meta property="og:url" content="http://blog.jongallant.com/2017/01/powerbi-embedded-javascript-api-range-slider-filter/index.html">
<meta property="og:site_name" content="Jon Gallant">
<meta property="og:description" content="I was recently asked to help build a “Range Slider” Power BI Custom Visual that simply filters a report based on the slider value. Unfortunately “filtering” is not currently supported in the new Power">
<meta property="og:image" content="http://blog.jongallant.com/2017/01/powerbi-embedded-javascript-api-range-slider-filter/000009.png">
<meta property="og:updated_time" content="2017-05-05T17:15:48.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="How to Embed and Filter a Power BI Report with the new Power BI Embedded JavaScript API">
<meta name="twitter:description" content="I was recently asked to help build a “Range Slider” Power BI Custom Visual that simply filters a report based on the slider value. Unfortunately “filtering” is not currently supported in the new Power">
<meta name="twitter:image" content="http://blog.jongallant.com/2017/01/powerbi-embedded-javascript-api-range-slider-filter/000009.png">
    

    
        <link rel="alternate" href="http://feeds.feedburner.com/jongallant" title="Jon Gallant" type="application/atom+xml" />
    

    
        <link rel="icon" href="/favicon.ico" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-1148981-8', 'auto');
ga('send', 'pageview');

</script>
    
    

</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">tech.leadership.music.coffee</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">Home</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/">Leadership</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Career-Model/">Career Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Productivity/">Productivity</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Review-Model/">Review Model</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Leadership/Work-Life-Balance/">Work:Life Balance</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Musings/">Musings</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/">Tech</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/3D-Printing/">3D Printing</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Announcements/">Announcements</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Azure/">Azure</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Bugs/">Bugs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Career/">Career</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Conferences/">Conferences</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/IoT/">IoT</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Jobs/">Jobs</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Microsoft/">Microsoft</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Power-BI/">Power BI</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Reviews/">Reviews</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tips/">Tips</a></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/category/Tech/Tutorials/">Tutorials</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/archives/">Archive</a>
                                </li>
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/contact/">Contact</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/category/Tech/">Tech</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/category/Tech/Power-BI/">Power BI</a>
    </h1>
</div>

                        
                        <div class="main-body-content">
                        <div class="banner-ad">
                        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- banner -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-7253926757222509"
     data-ad-slot="8838481977"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script></div>
                            <article id="post-powerbi-embedded-javascript-api-range-slider-filter" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        How to Embed and Filter a Power BI Report with the new Power BI Embedded JavaScript API
        </h1>
    

            </header>
        
        
            <div class="article-subtitle">
                
<a href="/2017/01/powerbi-embedded-javascript-api-range-slider-filter/" class="article-date">
    <time datetime="2017-01-03T14:20:05.000Z" itemprop="datePublished">2017-01-03</time>
</a>

                
    <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/powerbi/">powerbi</a></li></ul>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p>I was recently asked to help build a “Range Slider” Power BI Custom Visual that simply filters a report based on the slider value. Unfortunately “filtering” is not currently supported in the new <a href="https://github.com/Microsoft/PowerBI-visuals-tools" target="_blank" rel="external">Power BI Custom Visual SDK</a>, but should be in the next couple of months.</p>
<p>Since this customer is already using <a href="https://azure.microsoft.com/en-us/services/power-bi-embedded/" target="_blank" rel="external">Power BI Embedded</a>, I suggested that they use the new <a href="https://powerbi.microsoft.com/en-us/blog/intro-pbi-js-api/" target="_blank" rel="external">Power BI Embedded JavaScript API</a> to send filter commands from the hosting webpage to the embedded Power BI report.</p>
<p>It wasn’t as easy as it should be to get this implemented.  There’s the new <a href="https://microsoft.github.io/PowerBI-JavaScript/demo/code-demo/index.html" target="_blank" rel="external">demo site</a>, that helped with syntax, but it doesn’t allow you to change the filters.  <em>I hacked a version together that does allow you to edit the filter text, but uses JavaScript eval(), so the PR was denied, but the code still works. You can find my fork here: <a href="https://github.com/jonbgallant/PowerBI-JavaScript" target="_blank" rel="external">jonbgallant / PowerBI-JavaScript</a>.</em></p>
<p>You can find all of the working code from this walkthrough here: <a href="https://github.com/jonbgallant/powerbi-embedded-javascript-api-range-slider-filter" target="_blank" rel="external">jonbgallant / powerbi-embedded-javascript-api-range-slider-filter</a>.</p>
<h2 id="Create-Report-in-Power-BI-Desktop"><a href="#Create-Report-in-Power-BI-Desktop" class="headerlink" title="Create Report in Power BI Desktop"></a>Create Report in Power BI Desktop</h2><p>The first thing you are going to want to do is create a Power BI report using <a href="https://powerbi.microsoft.com/en-us/desktop/" target="_blank" rel="external">Power BI Desktop</a> that you can later embed and filter.  For this example, we are going to use a very simple table.</p>
<p>You can download this sample pbix from GitHub here: <a href="https://github.com/jonbgallant/powerbi-embedded-javascript-api-range-slider-filter/blob/master/powerbi-embedded-sample.pbix" target="_blank" rel="external">powerbi-embedded-sample.pbix</a></p>
<p><img src="000002.png" alt=""></p>
<p>I added a simple pie chart<br><img src="000007.png" alt=""></p>
<p>1. Open Power BI Desktop. Create a table and enter some data.<br>2. Save the .pbix file for later.</p>
<h2 id="Create-Power-BI-Embedded-Assets-in-Azure"><a href="#Create-Power-BI-Embedded-Assets-in-Azure" class="headerlink" title="Create Power BI Embedded Assets in Azure"></a>Create Power BI Embedded Assets in Azure</h2><p>The topology of the Power BI Embedded implementation is as follows: Power BI Workspace Collections contain Power BI Workspaces which contain Reports. You create the Workspace Collection on Azure and then use the Node.js CLI to add Workspaces to the Collection and then add Reports to the Workspace.  You’ll get the Access Key from the Azure Portal under the Workspace Collection.</p>
<h3 id="Create-Power-BI-Workspace-Collection"><a href="#Create-Power-BI-Workspace-Collection" class="headerlink" title="Create Power BI Workspace Collection"></a>Create Power BI Workspace Collection</h3><p>You have 3 options to create a Power BI Workspace Collection:</p>
<h4 id="1-Azure-CLI-1-0"><a href="#1-Azure-CLI-1-0" class="headerlink" title="1. Azure CLI 1.0"></a>1. Azure CLI 1.0</h4><p>This allows you to create the Workspace Collection without having to use the Azure Portal. Following this tutorial to create the Workspace Collection, get your Access Key and then come back to this post.</p>
<p><a href="http://blog.jongallant.com/2017/01/create-powerbi-embedded-workspace-collection-with-azure-cli-1-0">How to Create a Power BI Embedded Workspace Collection with the Azure Command Line Interface (CLI) 1.0</a></p>
<h4 id="2-Azure-Portal"><a href="#2-Azure-Portal" class="headerlink" title="2. Azure Portal"></a>2. Azure Portal</h4><p>1. Go to the <a href="https://portal.azure.com/#create/Microsoft.PowerBI" target="_blank" rel="external">Azure Portal</a> and create a new Power BI Workspace Collection.<br><img src="000004.png" alt=""><br><img src="000005.png" alt=""></p>
<p>2. Copy your Access Key to Notepad, you’ll need it later.<br><img src="000006.png" alt=""></p>
<h4 id="3-Azure-CLI-2-0"><a href="#3-Azure-CLI-2-0" class="headerlink" title="3. Azure CLI 2.0"></a>3. Azure CLI 2.0</h4><p>This option allows you to create the Power BI Workspace Collection, but there is currently no way to get the Access Keys via the CLI 2.0.  I do not recommend this approach at this time, but it will be the way going forward.  I will update this post once that support is added.</p>
<p><a href="http://blog.jongallant.com/2017/01/create-powerbi-embedded-workspace-collection-with-azure-cli-2-0">How to Create a Power BI Embedded Workspace Collection with the new Azure Command Line Interface (CLI) 2.0</a></p>
<h3 id="Install-the-Power-BI-CLI"><a href="#Install-the-Power-BI-CLI" class="headerlink" title="Install the Power BI CLI"></a>Install the Power BI CLI</h3><p>You just created the Workspace Collection, now we’ll create the Workspaces in that collection.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">npm i -g powerbi-cli</div></pre></td></tr></table></figure>
<h3 id="Create-Power-BI-Workspace"><a href="#Create-Power-BI-Workspace" class="headerlink" title="Create Power BI Workspace"></a>Create Power BI Workspace</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">powerbi create-workspace -c pbiejssample -k vq+0LR5JIod/7ztPI1iTWAqpc9dGVZWxsNSls8a2EORS43536VS0v275RBJMIMFB91/sHmxz7nJC+w2YOSixDA==</div></pre></td></tr></table></figure>
<ul>
<li>Replace -c value with your collection name</li>
<li>Replace -k with the Access Key for your Workspace Collection you created earlier. You can get that value from the Azure portal.</li>
</ul>
<p>You’ll then see the workspace Id:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[ powerbi ] Workspace created: d66d8e42-b92a-4576-9072-fbaafb872ae7</div></pre></td></tr></table></figure>
<h3 id="Get-Workspaces"><a href="#Get-Workspaces" class="headerlink" title="Get Workspaces"></a>Get Workspaces</h3><p>You could also use the get-workspaces command to get the workspace Id.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">powerbi get-workspaces -c pbiejssample -k vq+0LR5JIod/7ztPI1iTWAqpc9dGVZWxsNSls8a2EORS43536VS0v275RBJMIMFB91/sHmxz7nJC+w2YOSixDA==</div></pre></td></tr></table></figure>
<ul>
<li>Replace -c value with your collection name</li>
<li>Replace -k with the Access Key for your Workspace Collection you created earlier. You can get that value from the Azure portal.</li>
</ul>
<p>You’ll then see the workspaces in the provided collection<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[ powerbi ] ================================================</div><div class="line">[ powerbi ] Gettings workspaces for Collection: pbiejssample</div><div class="line">[ powerbi ] ================================================</div><div class="line">[ powerbi ] d66d8e42-b92a-4576-9072-fbaafb872ae7</div></pre></td></tr></table></figure></p>
<p>Copy that workspace Id to Notepad.</p>
<h3 id="Import-Report-Into-Workspace"><a href="#Import-Report-Into-Workspace" class="headerlink" title="Import Report Into Workspace"></a>Import Report Into Workspace</h3><p>Use the import command to add the report you created earlier to the workspace you just created. You’ll need to pass in collection, accesskey, workspace id, name and the path to the pbix file.<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">powerbi import -c pbiejssample -k vq+0LR5JIod/7ztPI1iTWAqpc9dGVZWxsNSls8a2EORS43536VS0v275RBJMIMFB91/sHmxz7nJC+w2YOSixDA== -w d66d8e42-b92a-4576-9072-fbaafb872ae7 -n &quot;Sample Data&quot; -f powerbi-embedded-sample.pbix</div></pre></td></tr></table></figure></p>
<ul>
<li>Replace -c value with your collection name</li>
<li>Replace -k with the Access Key for your Workspace Collection you created earlier. You can get that value from the Azure portal.</li>
<li>Replace -w with the workspace Id</li>
</ul>
<p>You’ll then see the success message<br><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[ powerbi ] Importing powerbi-embedded-sample.pbix to workspace: d66d8e42-b92a-4576-9072-fbaafb872ae7</div><div class="line">[ powerbi ] File uploaded successfully</div><div class="line">[ powerbi ] Import ID: c0dfa1c9-cc24-4330-b215-5d5e57cb39c7</div><div class="line">[ powerbi ] Checking import state: Publishing</div><div class="line">[ powerbi ] Checking import state: Succeeded</div><div class="line">[ powerbi ] Import succeeded</div></pre></td></tr></table></figure></p>
<blockquote>
<p>Do not confuse Import ID above with the Report ID. They aren’t the same thing.</p>
</blockquote>
<h3 id="Get-Report-ID"><a href="#Get-Report-ID" class="headerlink" title="Get Report ID"></a>Get Report ID</h3><p>Now that you have the report added to the Workspace, you need to get the report Id.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">powerbi get-reports -c pbiejssample -k vq+0LR5JIod/7ztPI1iTWAqpc9dGVZWxsNSls8a2EORS43536VS0v275RBJMIMFB91/sHmxz7nJC+w2YOSixDA== -w d66d8e42-b92a-4576-9072-fbaafb872ae7</div></pre></td></tr></table></figure>
<ul>
<li>Replace -c value with your collection name</li>
<li>Replace -k with the Access Key for your Workspace Collection you created earlier. You can get that value from the Azure portal.</li>
</ul>
<p>You’ll see the reports with Ids outputted</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[ powerbi ] =========================================</div><div class="line">[ powerbi ] Gettings reports for Collection: d66d8e42-b92a-4576-9072-fbaafb872ae7</div><div class="line">[ powerbi ] =========================================</div><div class="line">[ powerbi ] ID: 4964a947-857f-4c14-914d-c66e1c5713cd | Name: Sample Data</div></pre></td></tr></table></figure>
<p>Save that report Id to Notepad.</p>
<h3 id="Get-Embed-Token"><a href="#Get-Embed-Token" class="headerlink" title="Get Embed Token"></a>Get Embed Token</h3><p>You will need this token to embed a report into an HTML page.  In production scenarios you will generate this in real-time after you have authenticated your user.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">powerbi create-embed-token -c pbiejssample -k vq+0LR5JIod/7ztPI1iTWAqpc9dGVZWxsNSls8a2EORS43536VS0v275RBJMIMFB91/sHmxz7nJC+w2YOSixDA== -w d66d8e42-b92a-4576-9072-fbaafb872ae7 -r 4964a947-857f-4c14-914d-c66e1c5713cd</div></pre></td></tr></table></figure>
<ul>
<li>Replace -c value with your collection name</li>
<li>Replace -k with the Access Key for your Workspace Collection you created earlier. You can get that value from the Azure portal.</li>
<li>Replace -w with the workspace Id</li>
<li>Replace -r with the report Id</li>
</ul>
<p>That will output the embed token. Copy it to Notepad.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">[ powerbi ] Embed Token:  eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ2ZXIiOiIwLjIuMCIsImF1ZCI6Imh0dHBzOi8vYW5hbHlzaXMud2luZG93cy5uZXQvcG93ZXJiaS9hcGkiLCJpc3MiOiJQb3dlciBCSSBOb2RlIFNESyIsIndjbiI6InBiaWVqc3NhbXBsZSIsIndpZCI6ImQ2NmQ4ZTQyLWI5MmEtNDU3Ni05MDcyLWZiYWFmYjg3MmFlNyIsInJpZCI6IjQ5NjRhOTQ3LTg1N2YtNGMxNC05MTRkLWM2NmUxYzU3MTNjZCIsIm5iZiI6MTQ4MzQ4NTYzNywiZXhwIjoxNDgzNDg5MjM3fQ._2ziDo37r_9LqSBvur-azWjOlVmXAznd6NROWdjejfY</div></pre></td></tr></table></figure>
<blockquote>
<p>If at any point you get a permission denied or content doesn’t exist error, just rerun the create-embed-token command and use the new one that is created.  I think it expires in 20 minutes by default.</p>
</blockquote>
<p>You now have everything from Power BI that you that need to embed your report.</p>
<h2 id="Create-Webpage-to-Host-Power-BI-Report"><a href="#Create-Webpage-to-Host-Power-BI-Report" class="headerlink" title="Create Webpage to Host Power BI Report"></a>Create Webpage to Host Power BI Report</h2><h3 id="Install-the-Power-BI-Client-Side-JavaScript-API"><a href="#Install-the-Power-BI-Client-Side-JavaScript-API" class="headerlink" title="Install the Power BI Client Side JavaScript API"></a>Install the Power BI Client Side JavaScript API</h3><p>Find a good directory on your computer to create the website and install the powerbi-client npm package.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">npm i powerbi-client --save</div></pre></td></tr></table></figure>
<h3 id="Create-a-Webpage-that-contains-the-following-code"><a href="#Create-a-Webpage-that-contains-the-following-code" class="headerlink" title="Create a Webpage that contains the following code."></a>Create a Webpage that contains the following code.</h3><ul>
<li>Replace embedToken value with the embed token you created earlier.</li>
<li>Replace reportId value with the report Id you created earlier.</li>
</ul>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"reportContainer"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/powerbi-client/dist/powerbi.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line">        (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> embedToken = <span class="string">'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ2ZXIiOiIwLjIuMCIsImF1ZCI6Imh0dHBzOi8vYW5hbHlzaXMud2luZG93cy5uZXQvcG93ZXJiaS9hcGkiLCJpc3MiOiJQb3dlciBCSSBOb2RlIFNESyIsIndjbiI6InBiaWVqc3NhbXBsZSIsIndpZCI6ImQ2NmQ4ZTQyLWI5MmEtNDU3Ni05MDcyLWZiYWFmYjg3MmFlNyIsInJpZCI6IjQ5NjRhOTQ3LTg1N2YtNGMxNC05MTRkLWM2NmUxYzU3MTNjZCIsIm5iZiI6MTQ4MzQ4NTYzNywiZXhwIjoxNDgzNDg5MjM3fQ._2ziDo37r_9LqSBvur-azWjOlVmXAznd6NROWdjejfY'</span>;</div><div class="line">            <span class="keyword">var</span> reportId = <span class="string">'4964a947-857f-4c14-914d-c66e1c5713cd'</span>;</div><div class="line">            <span class="keyword">var</span> embedUrl = <span class="string">'https://embedded.powerbi.com/appTokenReportEmbed?reportId='</span> + reportId;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> config = &#123;</div><div class="line">                <span class="attr">type</span>: <span class="string">'report'</span>,</div><div class="line">                <span class="attr">accessToken</span>: embedToken,</div><div class="line">                <span class="attr">embedUrl</span>: embedUrl,</div><div class="line">                <span class="attr">id</span>: reportId,</div><div class="line">                <span class="attr">settings</span>: &#123;</div><div class="line">                    <span class="attr">filterPaneEnabled</span>: <span class="literal">false</span>,</div><div class="line">                    <span class="attr">navContentPaneEnabled</span>: <span class="literal">false</span></div><div class="line">                &#125;</div><div class="line">            &#125;;</div><div class="line"></div><div class="line">            powerbi.embed(<span class="built_in">document</span>.getElementById(<span class="string">'reportContainer'</span>), config);</div><div class="line"></div><div class="line">        &#125;)();</div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<blockquote>
<p>The above code won’t work in IE. Please see full example below for a version that works in IE.</p>
</blockquote>
<ul>
<li>You declared a div: reportContainer</li>
<li>You referenced the powerbi.min.js file.</li>
<li>You setup some variables to hold the token and reportId you created earlier</li>
<li>You called powerbi.embed to bind the report to the div.</li>
</ul>
<p>You should now see your report embedded into the webpage.  You can use http-server to serve the current folder from localhost.</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">npm i -g http-server</div></pre></td></tr></table></figure>
<p><img src="000008.png" alt=""></p>
<h2 id="Filter-Report-with-Range-Slider"><a href="#Filter-Report-with-Range-Slider" class="headerlink" title="Filter Report with Range Slider"></a>Filter Report with Range Slider</h2><p>We are now going to filter the report with a <a href="https://jqueryui.com/slider/" target="_blank" rel="external">jQuery UI Slider control</a>.</p>
<p>1. Install the jquery and jquery-ui npm packages</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">npm i jquery --save</div><div class="line">npm i jqueryui --save</div><div class="line">npm i es6-promise --save</div></pre></td></tr></table></figure>
<p>2. Reference the jquery and jquery-ui js and the css.<br><figure class="highlight html"><table><tr><td class="code"><pre><div class="line"></div><div class="line">// before end of <span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/jqueryui/jquery-ui.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/es6-promise/dist/es6-promise.auto.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line">// in <span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./node_modules/jqueryui/jquery-ui.min.css"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>3. Add a new div to your html page</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"slider"</span> /&gt;</span></div></pre></td></tr></table></figure>
<p>4. Add a new filter method to be called when your filter changes.</p>
<p>You can learn all about the JavaScript API <a href="https://github.com/Microsoft/PowerBI-JavaScript" target="_blank" rel="external">here</a>.</p>
<blockquote>
<p>The important thing to observe here is the table and column values.  Those are set to match the table and column names you created in Power BI Desktop earlier.</p>
</blockquote>
<p>The code will construct a filter based on the value passed to it and call the setFilters method on the report.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">values</span>) </span>&#123;</div><div class="line">    <span class="keyword">const</span> filter = &#123;</div><div class="line">        <span class="attr">$schema</span>: <span class="string">"http://powerbi.com/product/schema#basic"</span>,</div><div class="line">        <span class="attr">target</span>: &#123;</div><div class="line">            <span class="attr">table</span>: <span class="string">"Data"</span>,</div><div class="line">            <span class="attr">column</span>: <span class="string">"Value"</span></div><div class="line">        &#125;,</div><div class="line">        <span class="attr">operator</span>: <span class="string">"In"</span>,</div><div class="line">        <span class="attr">values</span>: values</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> report = powerbi.embeds[<span class="number">0</span>];</div><div class="line">    <span class="keyword">if</span> (report) &#123;</div><div class="line">        report.setFilters([filter])</div><div class="line">            .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(result);</div><div class="line">            &#125;)</div><div class="line">            .catch(<span class="function"><span class="keyword">function</span> (<span class="params">errors</span>) </span>&#123;</div><div class="line">                <span class="built_in">console</span>.log(errors);</div><div class="line">            &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>6. Instantiate the slider<br><figure class="highlight javascript"><table><tr><td class="code"><pre><div class="line">$(e =&gt; &#123;</div><div class="line">    $(<span class="string">"#slider"</span>).slider(&#123;</div><div class="line">        <span class="attr">min</span>: <span class="number">3</span>,</div><div class="line">        <span class="attr">max</span>: <span class="number">5</span>,</div><div class="line">        <span class="attr">step</span>: <span class="number">1</span>,</div><div class="line">        <span class="attr">slide</span>: <span class="function"><span class="keyword">function</span> (<span class="params">event, ui</span>) </span>&#123;</div><div class="line">            filter([ui.value]);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>7. When you now run the webpage you will see a slider control at the top and when you select “3” it will filter the pie chart to only those value that are equal to “3”</p>
<p><img src="000009.png" alt=""></p>
<p>Here’s a full working sample that you should be able to just copy and paste into your application after install the npm packages.</p>
<figure class="highlight html"><table><tr><td class="code"><pre><div class="line"><span class="meta">&lt;!doctype html&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Power BI Embedded with Filtering Sample<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./node_modules/jqueryui/jquery-ui.min.css"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></div><div class="line">    <span class="selector-id">#slider</span> &#123;</div><div class="line">        <span class="attribute">width</span>: <span class="number">500px</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-id">#reportContainer</span> &#123;</div><div class="line">        <span class="attribute">height</span>: <span class="number">500px</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="selector-id">#custom-handle</span> &#123;</div><div class="line">        <span class="attribute">width</span>: <span class="number">1.6em</span>;</div><div class="line">        <span class="attribute">height</span>: <span class="number">1.6em</span>;</div><div class="line">        <span class="attribute">top</span>: <span class="number">50%</span>;</div><div class="line">        <span class="attribute">margin-top</span>: -.<span class="number">8em</span>;</div><div class="line">        <span class="attribute">text-align</span>: center;</div><div class="line">        <span class="attribute">line-height</span>: <span class="number">1.6em</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"slider"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"custom-handle"</span> <span class="attr">class</span>=<span class="string">"ui-slider-handle"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"reportContainer"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/jquery/dist/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/jqueryui/jquery-ui.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/es6-promise/dist/es6-promise.auto.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./node_modules/powerbi-client/dist/powerbi.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"></div><div class="line">        $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">            <span class="keyword">var</span> handle = $(<span class="string">"#custom-handle"</span>);</div><div class="line">            $(<span class="string">"#slider"</span>).slider(&#123;</div><div class="line">                <span class="attr">min</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">max</span>: <span class="number">25</span>,</div><div class="line">                <span class="attr">step</span>: <span class="number">1</span>,</div><div class="line">                <span class="attr">create</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                    handle.text($(<span class="keyword">this</span>).slider(<span class="string">"value"</span>));</div><div class="line">                &#125;,</div><div class="line">                <span class="attr">slide</span>: <span class="function"><span class="keyword">function</span> (<span class="params">event, ui</span>) </span>&#123;</div><div class="line">                    handle.text(ui.value);</div><div class="line">                    filter([ui.value]);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line"></div><div class="line">            (<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">                <span class="keyword">var</span> embedToken = <span class="string">'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ2ZXIiOiIwLjIuMCIsImF1ZCI6Imh0dHBzOi8vYW5hbHlzaXMud2luZG93cy5uZXQvcG93ZXJiaS9hcGkiLCJpc3MiOiJQb3dlciBCSSBOb2RlIFNESyIsIndjbiI6InBiaWVqc3NhbXBsZSIsIndpZCI6ImQ2NmQ4ZTQyLWI5MmEtNDU3Ni05MDcyLWZiYWFmYjg3MmFlNyIsInJpZCI6IjQ5NjRhOTQ3LTg1N2YtNGMxNC05MTRkLWM2NmUxYzU3MTNjZCIsIm5iZiI6MTQ4MzY2MTY4OSwiZXhwIjoxNDgzNjY1Mjg5fQ.-g6Zh5AthZDCfZLEtvnl7mXDMBYjwauZyBORer--xb0'</span>;</div><div class="line">                <span class="keyword">var</span> reportId = <span class="string">'4964a947-857f-4c14-914d-c66e1c5713cd'</span>;</div><div class="line">                <span class="keyword">var</span> embedUrl = <span class="string">'https://embedded.powerbi.com/appTokenReportEmbed?reportId='</span> + reportId;</div><div class="line"></div><div class="line">                <span class="keyword">var</span> config = &#123;</div><div class="line">                    <span class="attr">type</span>: <span class="string">'report'</span>,</div><div class="line">                    <span class="attr">accessToken</span>: embedToken,</div><div class="line">                    <span class="attr">embedUrl</span>: embedUrl,</div><div class="line">                    <span class="attr">id</span>: reportId,</div><div class="line">                    <span class="attr">settings</span>: &#123;</div><div class="line">                        <span class="attr">filterPaneEnabled</span>: <span class="literal">false</span>,</div><div class="line">                        <span class="attr">navContentPaneEnabled</span>: <span class="literal">false</span></div><div class="line">                    &#125;</div><div class="line">                &#125;;</div><div class="line"></div><div class="line">                powerbi.embed($(<span class="string">'#reportContainer'</span>)[<span class="number">0</span>], config);</div><div class="line"></div><div class="line">            &#125;)();</div><div class="line">        &#125;);</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params">values</span>) </span>&#123;</div><div class="line">            <span class="keyword">const</span> filter = &#123;</div><div class="line">                <span class="attr">$schema</span>: <span class="string">"http://powerbi.com/product/schema#basic"</span>,</div><div class="line">                <span class="attr">target</span>: &#123;</div><div class="line">                    <span class="attr">table</span>: <span class="string">"Data"</span>,</div><div class="line">                    <span class="attr">column</span>: <span class="string">"Value"</span></div><div class="line">                &#125;,</div><div class="line">                <span class="attr">operator</span>: <span class="string">"In"</span>,</div><div class="line">                <span class="attr">values</span>: values</div><div class="line">            &#125;;</div><div class="line"></div><div class="line">            <span class="keyword">var</span> report = powerbi.embeds[<span class="number">0</span>];</div><div class="line">            <span class="keyword">if</span> (report) &#123;</div><div class="line">                report.setFilters([filter])</div><div class="line">                    .then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">                        <span class="built_in">console</span>.log(result);</div><div class="line">                    &#125;)</div><div class="line">                    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">errors</span>) </span>&#123;</div><div class="line">                        <span class="built_in">console</span>.log(errors);</div><div class="line">                    &#125;);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    <span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>

        </div>
        <footer>
        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>

                        </div>
                        <div style="width:64%;margin:auto;" data-type="ad" data-publisher="lqm.jongallant.site" data-format="728x90" data-zone="ros" data-tags="iot%2cangularjs%2cjavascript%2cnode%2cazureiot%2cazure%2cpowerbi%2cseattle%2cdeveloper%2cmicrosoft%2ctutorials"></div>
                    </section>
                    
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2017 Jon Gallant</p>
                <p>Disclaimer: The opinions expressed herein are my own personal opinions and do not represent my employer’s view in any way.</p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'jongallant';
    
    
    var disqus_url = 'http://blog.jongallant.com/2017/01/powerbi-embedded-javascript-api-range-slider-filter/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    


<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>

    <script type='text/javascript'>
function _dmBootstrap(file) {
    var _dma = document.createElement('script');
    _dma.type = 'text/javascript';
    _dma.async = true;
    _dma.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + file;
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(_dma);
}
function _dmFollowup(file) { if (typeof DMAds === 'undefined') _dmBootstrap('cdn2.DeveloperMedia.com/a.min.js'); }
(function () { _dmBootstrap('cdn1.DeveloperMedia.com/a.min.js'); setTimeout(_dmFollowup, 2000); })();
</script>
    
</body>
</html>
